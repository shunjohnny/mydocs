---
title: 2.3 コンポーネントの活用
tags:
  - Next.js
---

## データの一覧表示

JSXには繰り返し表示させる構文は無いため、  
{}で囲うことで使用できるJavaScriptの構文を使用して表示させる  

配列から順にkey, valueを取り出し、アロー関数に引数として渡される

```typescript title="mapメソッド"
{配列.map((引数)=>{
  return <JSX>
})}
```

### データを`<ul>`でリスト表示する

その前にリスト表示する箇所を装飾するためのcssを追記しておく
```css title="/src/App.css"
ul, ol {
  list-style-type: none;
  padding:0px;
}
li {
  text-align: left;
  font-size: 20px;
  padding: 5px;
  margin: 5px 20px;
  border: solid 2px lightgray;
  border-radius: 10px;
}
```

```typescript title="/src/App.js mapメソッドを使用してdataの中身を表示させる"
import './App.css'

function App(props) {
  const data = [
    {name:"Taro", mail:"taro@yamada"},
    {name:"Hanako", mail:"hanako@flower"},
    {name:"Sachiko", mail:"sachico@fhappy"}
  ]

  return (
    <div className = "App">
      <h1>{props.title}</h1>
      <ul>
        {data.map((item,key)=>{
          return(<li>{item.name} [{item.mail}]</li>)
        })}
      </ul>
    </div>
  )
}
export default App
```

<figure markdown="span">
  ![alt text](<../../../images/2.3 コンポーネントの活用/2.3 コンポーネントの活用_J0133291.png>){width="300"}
  <figconfig>実行結果</figconfig>
</figure>

<br>

## スタイルクラスの操作

スタイルクラスを追記しておく
```css title="/src/App.css スタイルクラス.ClassA, .ClassB"
.ClassA {
  font-size: 20px;
  font-weight: normal;
  border: solid 2px lightskyblue;
  padding:10px;
  margin: 10px 50px;
}

.ClassB {
  font-size: 20px;
  font-weight: bold;
  color: white;
  background-color: darkblue;
  padding: 12px;
  margin: 10px 50px;
}
```

```typescript title="/src/App.js クリック前後で、cssによる装飾が変化するプログラム"
import './App.css'
import {useState} from 'react'

function App(props) {
  var [flag, setFlag] = useState(true)
  const doClick = (event)=> {
    setFlag(!flag)
  }

  return (
    <div className = "App">
      <h1>{props.title}</h1>
      <p className={flag ? "ClassA": "ClassB"}>{flag ? "ON" : "OFF"}です。</p>
      <button className="button" onClick={doClick}>Click</button>
    </div>
  )
}

export default App
```

|クリック前|クリック後|
|---|---|
|![alt text](<../../../images/2.3 コンポーネントの活用/2.3 コンポーネントの活用_J0133291-1.png>)|![alt text](<../../../images/2.3 コンポーネントの活用/2.3 コンポーネントの活用_J0133291-2.png>)|

<br>

## スタイルオブジェクトの利用

コンポーネントのスタイルを設定する際className以外にstyleが存在  
styleでは値をオブジェクトで設定する必要あり　　

```typescript title="sytleの書き方"
{
    スタイル名: 値,
    スタイル名: 値,
    ...
}
```

!!! note "Note　「classとスタイルの違い」"
    className : 再利用性が高く、共通のスタイルを定期用するのに使うべき。cssファイルにまとめておくと綺麗  
    style : 一時的な変更や動的なスタイルには使えるが、大量のsytleを書くと汚い

下記のようにスタイルを使用したプログラムを作成する  
1. dataに無色透明の下地となる初期値を入れておく  
2. 赤丸を定義するobを作成、setDataを使用してクリックの度にdataに追加するdoClickを定義   
3. map関数でdataの中からitem, keyを取り出して描画

```typescript title="/src/App.js クリックで赤丸を表示させるプログラム"
import './App.css'
import {useState} from 'react'

function App(props) {
  var [count, setCount] = useState(0)

  //下地の用意
  var [data, setData] = useState([
    {
      position:"absolute",
      left:"0px", top:"0px",
      width:"100%", height:"100%",
      backgroundColor:"#fff0",
    }
  ])

  //クリックすると円を描く関数
  const doClick = (event)=> {
    const ob = {
      position:"absolute",
      left:(event.pageX - 50) + "px",
      top:(event.pageY - 50) + "px",
      width:"100px",
      height:"100px",
      backgroundColor:"#ff000066",
      borderRadius: "50%"
    }
    setData([...data, ob])
    setCount(count+1)
  }

  return (
    <div className="App">
      <h1>{props.title}</h1>
      <p>{count} objects.</p>
      <div onClick={doClick}>
        {data.map((item, key)=>{
          return(<div style = {item} key={key}></div>)
        })}
      </div>
    </div>
  )
}

export default App
```
<figure markdown="span">
  ![alt text](<../../../images/2.3 コンポーネントの活用/2.3 コンポーネントの活用_J0133291-3.png>){width="300"}
  <figconfig>実行結果</figconfig>
</figure>

## 複数コンポーネントの利用

Reactでは、表示する内容ごとにコンポーネントを分けて定義し、  
タグとして組み合わせることで、再利用しやすいコードを作成できる  

下記のようにMessege, Dataコンポーネントを作成して、  
Appコンポーネントの中で呼び出している

```typescript title="src/App.js 複数コンポーネントの利用例"
import './App.css'

//props.messageを表示するためのコンポーネント
function Message(props) {
  return (
    <p className = "ClassA">{props.message}</p>
  )
}

//props.data配列の要素をリストとして表示
function Data(props) {
  return (
    <ul>
      {props.data.map((item,key)=>{
        return(<li key={key}>{item.name}</li>)
      })}
    </ul>
  )
}

//titleと共に、MessageとDataコンポーネントを呼び出して表示
function App(props) {
  const data = [
    {name:"Taro"},
    {name:"Hanako"},
    {name:"Sachiko"},
  ]
  return (
    <div classNamei="App">
      <h1 className = "ClassB">{props.title}</h1>
      <Message message="This is sample message!"/>
      <Data data = {data}/>
    </div>
  )
}
export default App
```

<figure markdown="span">
  ![alt text](<../../../images/2.3 コンポーネントの活用/2.3 コンポーネントの活用_J0133291-4.png>){width="300"}
  <figconfig>実行結果</figconfig>
</figure>

## グローバル変数によるデータの共有

Reactでは、各コンポーネント内のstateは独立しているため、  
異なるコンポーネント間で直接データを共有できない  
しかし、グローバル変数を使えば、異なるコンポーネント間でデータを共有できる。  

下記ではdataというグローバル変数を定義し、messageと名前のリストを持たせている
各コンポーネントでこのdataを参照することで、データの共有を実現

```typescript title="src/App.js グローバル変数の利用例"
import './App.css'
import { useState } from 'react'

// グローバル変数 data
// 他のコンポーネントでも共有されるデータを保持
var data = {
  data: [
    { name: "Taro" },
    { name: "Hanako" },
    { name: "Sachiko" }
  ],
  message: "Hello", // 初期メッセージ
}

// Messageコンポーネント
// data.messageの内容を表示するだけのコンポーネント
function Message() {
  return (
    <p className="ClassA">{data.message}</p>
  )
}

// Dataコンポーネント
// data.data配列の各名前をリストとして表示
function Data() {
  return (
    <ul>
      {data.data.map((item, key) => {
        return (<li key={key}>{item.name}</li>) // 各名前を<li>として表示
      })}
    </ul>
  )
}

// Appコンポーネント
// 全体の構成とイベント処理を管理
function App(props) {
  const [input, setInput] = useState("")
  // 入力が変更されたときに呼ばれる関数
  const doChange = (event) => {
    setInput(event.target.value) // 入力内容をステートに保存
  }
  // ボタンがクリックされたときに呼ばれる関数
  const doClick = () => {
    data.data.push({ name: input }) // data.data配列に新しい名前を追加
    data.message = `you typed: "${input}".` // メッセージを更新
    setInput("") // 入力フィールドをクリア
  }
  return (
    <div className="App">
      <h1 className="ClassB">{props.title}</h1>
      <Message />
      <div>
        <input onChange={doChange} value={input} />
        <button onClick={doClick}>Click</button>
      </div>
      <Data />
    </div>
  )
}
export default App
```

<figure markdown="span">
  ![alt text](<../../../images/2.3 コンポーネントの活用/2.3 コンポーネントの活用_J0133291-5.png>){width="300"}
  <figconfig>実行結果</figconfig>
</figure>