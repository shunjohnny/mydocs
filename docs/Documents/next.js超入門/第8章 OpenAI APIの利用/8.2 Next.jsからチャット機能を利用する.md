---
title: 8.2 Next.jsからチャット機能を利用する
tags:
  - Next.js
---

OpenAIのapiを使用して質問に対して答えてくれるコンポーネントを作成する

```typescript title="src/app/pages.tsx"
"use client"
import { useState } from 'react'

const url = 'https://api.openai.com/v1/chat/completions'
const api_key = 'APIキーをここに入力してください'

export default function Home() {
  const [input, setInput] = useState('')
  const [prompt, setPrompt] = useState('')
  const [assistant, setAssistant] = useState('')

  const doChange = (event) => {
    setInput(event.target.value)
  }
  const doAction = ()=> {
    setPrompt(input)
    setAssistant('wait...')
    const body_content = {
      "model": "gpt-3.5-turbo",
      "messages": [
        {
          "role": "system",
          "content": "日本語で100文字以内で答えてください。"
        },
        {
          "role": "user",
          "content": input
        }
      ]
    }
    const opts = {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer " + api_key
      },
      body: JSON.stringify(body_content)
    }
    fetch(url, opts)
      .then(response => response.json())
      .then(json_data => {
        const result = json_data.choices[0].message.content.trim();
      setInput('')
      setAssistant(result)
      }
    );
  }

  return (
    <main>
      <h1 className="title">Index page</h1>
      <p className="msg font-bold">プロンプトを入力:</p>
      <div className="mx-5">
        <input type="text" className="input"
          value={input} onChange={doChange}/>
        <button className="btn" onClick={doAction}>Send</button>
      </div>
      <div className="prompt">
        <p className="">PROMPT: {prompt}</p>
        <p className="">ASSISTANT: {assistant}</p>
      </div>
    </main>
  )
}
```