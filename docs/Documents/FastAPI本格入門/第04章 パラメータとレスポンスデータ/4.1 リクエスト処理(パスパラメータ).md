---
title: 4.1 リクエスト処理(パスパラメータ)
tags:
  - FastAPI
---

## 4-1-1 パスパラメータの基本

|バスパラメータ|
|---|
|WebAPIにおけるリクエストの処理<br>URLの一部に埋め込まれる変数のような値|

下記では例えば「users/123」にアクセスすると、get_userの引数に「123」が入る

```python title="パスパラメータの使用例"
@app.get("/users/{user_id}")
async def get_user(user_id: int):
```

## 4-1-2 FastAPIプログラム(パスパラメータ)の作成

```python title="data.py　ユーザー情報を定義して、user_idに一致するユーザー情報を返す"
from typing import Optional

class User:
    def __init__(self, id: int, name: str):
        self.id = id
        self.name = name

user_list = [
    User(id=1, name="内藤"),
    User(id=2, name="辻"),
    User(id=3, name="鷹木"),
]

def get_user(user_id: int) -> Optional[User]:
    for user in user_list:
        if user.id == user_id:
            return user
    return None
```

```python title="main.py　入力idに対し、data.pyのget_userを使用し、一致しているのであればidとnameを返すAPI"
from fastapi import FastAPI, HTTPException
from typing import Optional
from data import get_user, User

app = FastAPI()

@app.get("/users/{user_id}")
async def read_user(user_id: int) -> dict:
    user: Optional[User] = get_user(user_id)
    if user is None:
        raise HTTPException(status_code=404, detail="User not found")
    return {"user_id": user.id, "username": user.name}
```

## 4-1-3 Swagger UIでの操作

下記コマンドでSwagger UIを起動

```bash 
uvicorn main:app --reload
```

try it outからuser_idを入力し、Excuteすると動き、返り値を確認できる

<figure markdown="span">
  ![alt text](<../../../images/4.1 リクエスト処理(パスパラメータ)/4.1 リクエスト処理(パスパラメータ)_J0133291.png>)
  <figconfig>Swagger UIの使用</figconfig>
</figure>